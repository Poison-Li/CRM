<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>

    <script src={{ url_for('static', filename='customer/customer_do_xml.js') }}></script>

</head>
<body>
<div class="container">
	<div class="row clearfix">
		<div class="col-md-12 column">
			<div class="row clearfix">
				<div class="col-md-12 column">
					<h3>
					    CRM系统
                    </h3>
                    <ul>
                        <li><a href={{ url_for('product.get_products') }}>product</a></li>
                        <li><a href={{ url_for('trade.get_trades') }}>trade</a></li>
                    </ul>
				</div>
			</div>
			<div class="row clearfix">
				<div class="col-md-12 column">
					<table class="table" id="table">
						<thead>
							<tr>
								<th>
									ID
								</th>
								<th>
									姓名
								</th>
								<th>
									性别
								</th>
								<th>
									年龄
								</th>
                                <th>
									电话
								</th>
                                <th id='modify'>
                                    修改
                                </th>
                                <th id="delete">
                                    删除
                                </th>
							</tr>
						</thead>
						<tbody id="tbody">

						</tbody>
					</table>
				</div>
                <div>
                      <form id="form" name="form">
                        name:<input type="text"/>
                        sex:<input type="text"/>
                        age:<input type="text"/>
                        phone:<input type="text"/>
                      </form>
                    <button type="submit" onclick="javascript:addsubmit()">+</button>
                    <el-button id="add_button" native-type="submit" onclick="javascript:addsubmit()">+</el-button>
                </div>
			</div>
		</div>
	</div>
</div>

<script>
    var Main = {
        data() {
            return {
                visible: false
            }
        }
    };

    var Ctor = Vue.extend(Main)
    new Ctor().$mount('#add_button')

    $(function(){
        content = get_xml('{{ customers|tojson }}');
        document.getElementById("tbody").innerHTML = content;
    });


    function addsubmit() {
        var form = document.getElementById('form')
        if (form[0].value=='' || form[1].value=='' || form[2].value=='' || form[3].value=='') {
            alert('error');
            return '';
        }
        content = add(form[0].value,form[1].value,form[2].value,form[3].value);
      //  console.log(content)
        var oSerializer = new XMLSerializer();
        var sXML = oSerializer.serializeToString(content);  //序列化不可少
       // console.log(sXML);
        $.ajax({
                    url:'/customer/addCustomer/',
                    data:JSON.stringify({
                        'info':sXML
                    }),
                    type:'post',
                    dataType:'json',
                    contentType:"application/json",
                    success:function (data) {
                        if(data.msg=='success'){
                        location.reload();
                        }
                    }
                });
    }

</script>
</body>
</html>